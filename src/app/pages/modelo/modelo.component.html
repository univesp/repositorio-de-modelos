<div class="modelo">

    <app-filter class="modelo__filter"></app-filter>

    <div class="modelo__container">
        <div class="modelo__tituloBox">
            <p> {{ currentModelo?.date }} | {{ currentModelo?.id }} </p>
            <div class="modelo-title-actionButton">
                <div class="title-and-bookmark">
                    <h1> {{ currentModelo?.titulo }} </h1>
                    <span (click)="toggleBookmark(currentModelo)" *ngIf="isLoggedIn">
                        <mat-icon 
                        class="icon-bookmark" 
                        aria-hidden="false" 
                        aria-label="BookMark icon" 
                        [fontIcon]=" currentModelo.isSalvo ? 'bookmark' : 'bookmark_border' ">
                        </mat-icon>
                    </span>
                </div>

                <div class="modelo-action-buttons" *ngIf="isLoggedIn">
                    <!-- Botão de três pontos -->
                    <button class="menu-tres-pontos-button" 
                            (click)="toggleMenuOpcoes()"
                            aria-label="Opções do modelo">
                        <mat-icon>more_vert</mat-icon>
                    </button>
                    <!-- Menu de opções -->
                    <div class="menu-opcoes" *ngIf="menuOpcoesAberto">
                        <button class="opcao-menu" (click)="editarModelo()">
                            <mat-icon>edit</mat-icon>
                            <span>Editar Modelo</span>
                        </button>
                        
                        <button class="opcao-menu" 
                                (click)="adicionarAoTopo()"
                                *ngIf="(authService.userProfile$ | async)?.role === 'ADMIN'">
                            <mat-icon>view_carousel</mat-icon>
                            <span>Adicionar ao Topo</span>
                        </button>
                        
                        <button class="opcao-menu" 
                                (click)="adicionarAosDestaques()"
                                *ngIf="(authService.userProfile$ | async)?.role === 'ADMIN'">
                            <mat-icon>star</mat-icon>
                            <span>Adicionar aos Destaques</span>
                        </button>
                        
                        <button class="opcao-menu opcao-excluir" 
                                (click)="excluirModelo()"
                                *ngIf="(authService.userProfile$ | async)?.role === 'ADMIN'">
                            <mat-icon>delete</mat-icon>
                            <span>Excluir Modelo</span>
                        </button>
                    </div>
                </div>
                
                
            </div>
        </div>

        <div class="modelo__galeriaImagens">
            <img src="{{ currentModelo.img_lg }}" alt="{{ currentModelo.titulo }}"
             (click)="abrirModalImagem(currentModelo.img_lg)">
        </div>

        <!-- Modal para imagem ampliada -->
        <div class="modal-imagem" *ngIf="modalAberto" (click)="fecharModalImagem()">
            <div class="modal-conteudo" (click)="$event.stopPropagation()">
                <button class="modal-fechar" (click)="fecharModalImagem()">
                    <mat-icon>close</mat-icon>
                </button>
                <img [src]="imagemModal" alt="{{ currentModelo.titulo }}">
            </div>
        </div>

        <div class="modelo__detailsBox">
            <div class="modelo__col1">
                <a href="{{ currentModelo.link }}" target="_blank">
                    Acessar Material
                    <mat-icon>open_in_new</mat-icon>
                </a>
            </div>
        </div>

        <div class="modelo-info-container">

            <div class="modelo-info-descricao">
                <h3>Descrição</h3>
                <div>
                    {{ currentModelo.descricao }}
                </div>
            </div>

            <div class="modelo-col-2">
                <div class="modelo-other-info">

                    <div class="modelo-other-info-item">
                        <span class="modelo-formato"> {{ currentModelo.formato }} </span>
                    </div>
    
                    <div class="modelo-other-info-item">
                        <span class="other-info-title">Data de adição:</span>
                        <span class="other-info-content"> {{ currentModelo.date }} </span>
                    </div>
    
                    <div class="modelo-other-info-item">
                        <span class="other-info-title">Curso(s):</span>
                        <span class="other-info-content"> {{ currentModelo.curso.join(', ') }} </span>
                    </div>
    
                    <div class="modelo-other-info-item">
                        <span class="other-info-title">Área(s) de Conhecimento:</span>
                        <span class="other-info-content"> {{ currentModelo.area.join(', ') }} </span>
                    </div>
    
                    <div class="modelo-other-info-item">
                        <span class="other-info-title">Categoria(s):</span>
                        <span class="other-info-content"> {{ currentModelo.categorias.join(', ') }} </span>
                    </div>
    
                    <div class="modelo-other-info-item">
                        <span class="other-info-title">Tipo:</span>
                        <span class="other-info-content"> {{ currentModelo.tipo.join(', ') }} </span>
                    </div>
    
                    <div class="modelo-other-info-item">
                        <span class="other-info-title">Tecnologia(s):</span>
                        <span class="other-info-content"> {{ currentModelo.tecnologia.join(', ') }} </span>
                    </div>
    
                    <div class="modelo-other-info-item">
                        <span class="other-info-title">Acessibilidade:</span>
                        <span class="other-info-content"> 
                            {{ currentModelo.acessibilidade ? currentModelo.acessibilidade.join(', ') : 'Este recurso não conta com nenhum tipo de acessibilidade.' }} 
                        </span>
                    </div>
    
                    <div class="modelo-other-info-item">
                        <span class="other-info-title">Licença:</span>
                        <span class="other-info-content"> {{ currentModelo.licenca }} </span>
                    </div>
    
                    <div class="modelo-other-info-item">
                        <span class="other-info-title">Código-fonte disponível?</span>
                        <span class="other-info-content"> {{ currentModelo.hasCodigo ? 'Sim' : 'Não' }} </span>
                        <div class="github-info" *ngIf="currentModelo.hasCodigo">
                            <span class="other-info-title">Link: </span>
                            <span class="other-info-content"> <a class="link-codigo" target="_blank" href="{{ currentModelo.github}}">{{ currentModelo.github}}</a> </span>
                        </div>
                    </div>
    
                    <div class="modelo-other-info-item">
                        <span class="other-info-title">Autoria:</span>
                        <span class="other-info-content"> {{ currentModelo.autor }} </span>
                    </div>
    
                    <div class="modelo-equipe-responsavel" *ngIf="currentModelo.hasEquipe">
                        <span class="modelo-equipe-title">Equipe</span>
                        <hr>
                        <br>
                        <div class="modelo-equipe-responsavel-item">
                            <span class="other-info-title">Docente:</span>
                            <span class="other-info-content"> {{ currentModelo.equipe.docente }} </span>
                        </div>
    
                        <div class="modelo-equipe-responsavel-item">
                            <span class="other-info-title">Coordenação:</span>
                            <span class="other-info-content"> {{ currentModelo.equipe.coordenacao }} </span>
                        </div>
    
                        <div class="modelo-equipe-responsavel-item">
                            <span class="other-info-title">Roteirização:</span>
                            <span class="other-info-content"> {{ currentModelo.equipe.roteirizacao }} </span>
                        </div>
    
                        <div class="modelo-equipe-responsavel-item">
                            <span class="other-info-title">Ilustração:</span>
                            <span class="other-info-content"> {{ currentModelo.equipe.ilustracao }} </span>
                        </div>
    
                        <div class="modelo-equipe-responsavel-item">
                            <span class="other-info-title">Layout:</span>
                            <span class="other-info-content"> {{ currentModelo.equipe.layout }} </span>
                        </div>
    
                        <div class="modelo-equipe-responsavel-item">
                            <span class="other-info-title">Programação:</span>
                            <span class="other-info-content"> {{ currentModelo.equipe.programacao }} </span>
                        </div>
                    </div>
    
                </div>

                <div class="modelo-tags-container">
                    <div class="tags-list">
                        <span class="tag" *ngFor="let tag of currentModelo.tags">
                            {{ tag }}
                        </span>
                    </div>
                </div>
            </div>

        </div>

        <!-- Seção Modelos Similares -->
        <div class="modelos-similares" *ngIf="modelosSimilares && modelosSimilares.length > 0">
            <h2 class="modelos-similares__titulo">Modelos similares</h2>
            
            <div class="modelos-similares__lista">
                <div class="modelo-similar-card" 
                    *ngFor="let modelo of modelosSimilares"
                    (click)="navegarParaModelo(modelo.id)">
                    
                    <div class="modelo-similar__conteudo">
                        <img class="modelo-similar__imagem" src="{{ modelo.img_lg }}" alt="">
                        <h3 class="modelo-similar__titulo">{{ modelo.titulo }}</h3>
                    </div>
                </div>
            </div>
        </div>
        
    </div>
</div>

